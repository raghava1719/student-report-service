<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:munit="http://www.mulesoft.org/schema/mule/munit" xmlns:munit-tools="http://www.mulesoft.org/schema/mule/munit-tools"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation"
	xsi:schemaLocation="
		http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
		http://www.mulesoft.org/schema/mule/munit http://www.mulesoft.org/schema/mule/munit/current/mule-munit.xsd
		http://www.mulesoft.org/schema/mule/munit-tools  http://www.mulesoft.org/schema/mule/munit-tools/current/mule-munit-tools.xsd">
	<munit:config name="get-send-report-suite.xml" />
	<munit:test name="get:\send-report\(ID):student-report-service-config-test" doc:id="046a6da9-40c7-4436-8970-54cde6967351" >
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock Request" doc:id="8eef0989-59c2-4a4e-b117-da2559b3b67f" processor="http:request">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="40729eee-a2e1-41d9-bfd1-47c33e6d6164" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value="#[payload]" encoding="UTF-8" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock when" doc:id="c9c143aa-f98d-4299-a393-44e723a41211" processor="sftp:read">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="8734bbab-003f-4bb2-a01c-21eef9522d2c" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#["ID,Name,Email,Final_Section,Total Score,Course Status&#10;a01dN00000e8DicQAE,Raghava,raghava@example.com,E,780,Failed&#10;,,,,,&#10;,,,,,&#10;,,,,,&#10;Day of Course,Section,Subject 1,Subject 2,Subject 3,Day Total,Weighted Score,Created Date&#10;1,D,200,200,200,600,360,2025-08-07T20:17:02&#10;2,C,200,300,200,700,420,2025-08-07T23:28:02&#10;3,C,0,0,0,0,0,2025-08-07T23:36:01&#10;4,D,0,0,0,0,0,2025-08-07T23:44:33&#10;5,E,0,0,0,0,0,2025-08-07T23:50:13"]' mediaType="application/octet-stream" />
					<munit-tools:attributes value='#[{&#10;	fileName : "fileName"&#10;}]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock when" doc:id="10040891-c333-4c3a-977e-36ad5f1173ab" processor="email:send">
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock when" doc:id="933fc54a-c12d-4a15-b443-397c41c2af25" processor="jms:publish">
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="d1ec147a-1dc7-4ac7-991a-8cc40a230413" attributeName="doc:id" />
				</munit-tools:with-attributes>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<set-variable value='#[{&#10;        "id": "a01dN00000e7UlzQAE",&#10;        "name": "Raghuveer",&#10;        "email": "raghuu3@example.com",&#10;        "admission_percentage": 95,&#10;        "address": "DLF",&#10;        "current_section": "A",&#10;        "cumulated_score": 2730,&#10;        "days_left": 0,&#10;        "total_score": 7500,&#10;        "report_file_path": "reports/a01dN00000e7UlzQAE.csv",&#10;        "created_date": "2025-08-07T14:00:30"&#10;    }]' doc:name="Set Variable" doc:id="2b5c9e87-0b58-4cc0-a890-d79c4c4e4359" variableName="student"/>
			<munit:set-event doc:name="Set Event" doc:id="942362c7-ca39-4fab-aed1-9694baa449bd" >
				<munit:attributes value='#[{&#10;	queryParams : {&#10;		ID : "a01dN00000eAC0tQAG"&#10;	}&#10;}]' />
			</munit:set-event>
			<flow-ref doc:name="Flow-ref to get:\send-report\(ID):student-report-service-config" doc:id="d5f2f391-7eda-49d6-b8ac-55da7465d589" name="get:\send-report\(ID):student-report-service-config"/>
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-that doc:name="Assert that" doc:id="3267369c-3706-45f0-bcb1-f195e603eacf" expression="#[payload]" is="#[MunitTools::notNullValue()]"/>
		</munit:validation>
	</munit:test>
	<munit:test name="get:\send-report\(ID):student-report-service-config-test2" doc:id="fdada1f0-e02a-4087-af0c-71706c5842b5" >
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock Request" doc:id="0a5a322c-b1d1-4ee6-91e8-f483d187afc7" processor="http:request" >
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="40729eee-a2e1-41d9-bfd1-47c33e6d6164" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value="#[payload]" encoding="UTF-8" />
					<munit-tools:error typeId="HTTP:BAD_REQUEST" />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock when" doc:id="9d915900-c7c6-48b5-b1c7-a3549d57b72a" processor="sftp:read" >
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="8734bbab-003f-4bb2-a01c-21eef9522d2c" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#["ID,Name,Email,Final_Section,Total Score,Course Status&#10;a01dN00000e8DicQAE,Raghava,raghava@example.com,E,780,Failed&#10;,,,,,&#10;,,,,,&#10;,,,,,&#10;Day of Course,Section,Subject 1,Subject 2,Subject 3,Day Total,Weighted Score,Created Date&#10;1,D,200,200,200,600,360,2025-08-07T20:17:02&#10;2,C,200,300,200,700,420,2025-08-07T23:28:02&#10;3,C,0,0,0,0,0,2025-08-07T23:36:01&#10;4,D,0,0,0,0,0,2025-08-07T23:44:33&#10;5,E,0,0,0,0,0,2025-08-07T23:50:13"]' mediaType="application/octet-stream" />
					<munit-tools:attributes value='#[{&#10;	fileName : "fileName"&#10;}]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock when1" doc:id="867cefac-3a11-4c6f-bf8b-7fdaf110896a" processor="email:send" />
			<munit-tools:mock-when doc:name="Mock when2" doc:id="8ec83b11-aa1c-48f3-9071-5f9e8639b4b3" processor="jms:publish" >
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="d1ec147a-1dc7-4ac7-991a-8cc40a230413" attributeName="doc:id" />
				</munit-tools:with-attributes>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<set-variable value='#[{&#10;        "id": "a01dN00000e7UlzQAE",&#10;        "name": "Raghuveer",&#10;        "email": "raghuu3@example.com",&#10;        "admission_percentage": 95,&#10;        "address": "DLF",&#10;        "current_section": "A",&#10;        "cumulated_score": 2730,&#10;        "days_left": 0,&#10;        "total_score": 7500,&#10;        "report_file_path": "reports/a01dN00000e7UlzQAE.csv",&#10;        "created_date": "2025-08-07T14:00:30"&#10;    }]' doc:name="Set Variable" doc:id="c376a37a-0757-489c-8ec9-d12bd7764961" variableName="student" />
			<munit:set-event doc:name="Set Event" doc:id="9ad83340-79ec-4027-ae94-7c1d88953d8d" >
				<munit:attributes value='#[{&#10;	queryParams : {&#10;		ID : "a01dN00000eAC0tQAG"&#10;	}&#10;}]' />
			</munit:set-event>
			<flow-ref doc:name="Flow-ref to get:\send-report\(ID):student-report-service-config" doc:id="ae751f99-4840-46db-a667-435633f1178e" name="get:\send-report\(ID):student-report-service-config" />
		</munit:execution>
		<munit:validation>
			<munit-tools:assert-equals doc:name="Assert equals" doc:id="90206685-3a0f-4255-b150-502ed77757f4" actual="#[payload.statusCode]" expected="#[500]"/>
		</munit:validation>
	</munit:test>
	<munit:test name="get:\send-report\(ID):student-report-service-config-test3" doc:id="0d92ad1c-7867-4349-81b9-7da5f6a554ef" >
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock Request" doc:id="077695a6-0e3a-4e0a-a14b-58a1bbe57e3d" processor="http:request" >
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="40729eee-a2e1-41d9-bfd1-47c33e6d6164" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value="#[payload]" encoding="UTF-8" />
					<munit-tools:attributes value='#[{&#10;	uriParams : {&#10;		ID : "a01dN00000eAC0tQAG"&#10;	}&#10;}]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock when" doc:id="3e265a80-3578-496e-8888-d5e320cc4b57" processor="sftp:read" >
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="8734bbab-003f-4bb2-a01c-21eef9522d2c" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#["ID,Name,Email,Final_Section,Total Score,Course Status&#10;a01dN00000e8DicQAE,Raghava,raghava@example.com,E,780,Failed&#10;,,,,,&#10;,,,,,&#10;,,,,,&#10;Day of Course,Section,Subject 1,Subject 2,Subject 3,Day Total,Weighted Score,Created Date&#10;1,D,200,200,200,600,360,2025-08-07T20:17:02&#10;2,C,200,300,200,700,420,2025-08-07T23:28:02&#10;3,C,0,0,0,0,0,2025-08-07T23:36:01&#10;4,D,0,0,0,0,0,2025-08-07T23:44:33&#10;5,E,0,0,0,0,0,2025-08-07T23:50:13"]' mediaType="application/octet-stream" />
					<munit-tools:attributes value='#[{&#10;	fileName : "fileName"&#10;}]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock when1" doc:id="6970c46e-6dcd-4838-8f3e-710f3ffeed4b" processor="email:send" />
			<munit-tools:mock-when doc:name="Mock when2" doc:id="17cbe5b7-c334-4ac7-8c0a-4251ded2eed8" processor="jms:publish" >
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="d1ec147a-1dc7-4ac7-991a-8cc40a230413" attributeName="doc:id" />
				</munit-tools:with-attributes>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<munit:set-event doc:name="Set Event" doc:id="9d2e020b-619b-48f9-b18f-c82e7eb919da" >
				<munit:attributes value='#[{&#10;	uriParams : {&#10;		ID : "a01dN00000eAC0tQAG"&#10;	}&#10;}]' />
			</munit:set-event>
			<set-variable value='#[{&#10;        "id": "a01dN00000e7UlzQAE",&#10;        "name": "Raghuveer",&#10;        "email": "raghuu3@example.com",&#10;        "admission_percentage": 95,&#10;        "address": "DLF",&#10;        "current_section": "A",&#10;        "cumulated_score": 2730,&#10;        "days_left": 0,&#10;        "total_score": 7500,&#10;        "report_file_path": "reports/a01dN00000e7UlzQAE.csv",&#10;        "created_date": "2025-08-07T14:00:30"&#10;    }]' doc:name="Set Variable" doc:id="6fa78b37-12f0-43a8-8795-51a6cbb552d2" variableName="student" />
			<flow-ref doc:name="Flow-ref to get:\send-report\(ID):student-report-service-config" doc:id="f2050a5e-f8c3-4aa2-9211-df0e2ec50106" name="get:\send-report\(ID):student-report-service-config" />
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-equals doc:name="Assert equals" doc:id="ce00cd20-a7d9-4bec-b3ec-a1ce102cc980" actual="#[payload]" expected='#[{&#10;	message: "Report card sent to email: "++ vars.student.email ++ "."&#10;}]'/>
		</munit:validation>
	</munit:test>
	<munit:test name="get:\send-report\(ID):student-report-service-config-test1" doc:id="68d2ac7e-cc60-4e23-a938-b3ec0bf6b0bd" >
		<munit:behavior >
			<munit-tools:mock-when doc:name="Mock Request" doc:id="1903c13a-be94-4c3d-ae63-79e73a5840de" processor="http:request" >
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="40729eee-a2e1-41d9-bfd1-47c33e6d6164" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value="#[payload]" encoding="UTF-8" />
					<munit-tools:attributes value='#[{&#10;	uriParams : {&#10;		ID : "a01dN00000eAC0tQAG"&#10;	}&#10;}]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock when" doc:id="395f326c-d5a9-4a2e-8d3d-1c70f83b56fc" processor="sftp:read" >
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="8734bbab-003f-4bb2-a01c-21eef9522d2c" attributeName="doc:id" />
				</munit-tools:with-attributes>
				<munit-tools:then-return >
					<munit-tools:payload value='#["ID,Name,Email,Final_Section,Total Score,Course Status&#10;a01dN00000e8DicQAE,Raghava,raghava@example.com,E,780,Failed&#10;,,,,,&#10;,,,,,&#10;,,,,,&#10;Day of Course,Section,Subject 1,Subject 2,Subject 3,Day Total,Weighted Score,Created Date&#10;1,D,200,200,200,600,360,2025-08-07T20:17:02&#10;2,C,200,300,200,700,420,2025-08-07T23:28:02&#10;3,C,0,0,0,0,0,2025-08-07T23:36:01&#10;4,D,0,0,0,0,0,2025-08-07T23:44:33&#10;5,E,0,0,0,0,0,2025-08-07T23:50:13"]' mediaType="application/octet-stream" />
					<munit-tools:attributes value='#[{&#10;	fileName : "fileName"&#10;}]' />
				</munit-tools:then-return>
			</munit-tools:mock-when>
			<munit-tools:mock-when doc:name="Mock when1" doc:id="6af79202-e06d-4071-9d64-2b232f47b4e1" processor="email:send" />
			<munit-tools:mock-when doc:name="Mock when2" doc:id="783521d9-cb31-4033-b12e-7d4be0c6aaf1" processor="jms:publish" >
				<munit-tools:with-attributes >
					<munit-tools:with-attribute whereValue="d1ec147a-1dc7-4ac7-991a-8cc40a230413" attributeName="doc:id" />
				</munit-tools:with-attributes>
			</munit-tools:mock-when>
		</munit:behavior>
		<munit:execution >
			<munit:set-event doc:name="Set Event" doc:id="c0ae9898-6f0f-4882-9c9f-947e515756b5" >
				<munit:attributes value='#[{&#10;	uriParams : {&#10;		ID : "a01dN00000eAC0tQAG"&#10;	}&#10;}]' />
			</munit:set-event>
			<set-variable value='#[{&#10;        "id": "a01dN00000e7UlzQAE",&#10;        "name": "Raghuveer",&#10;        "email": "raghuu3@example.com",&#10;        "admission_percentage": 95,&#10;        "address": "DLF",&#10;        "current_section": "A",&#10;        "cumulated_score": 2730,&#10;        "days_left": 0,&#10;        "total_score": 7500,&#10;        "report_file_path": "-",&#10;        "created_date": "2025-08-07T14:00:30"&#10;    }]' doc:name="Set Variable" doc:id="124a2200-80b8-49b1-bb5c-9435b6f529d2" variableName="student" />
			<flow-ref doc:name="Flow-ref to get:\send-report\(ID):student-report-service-config" doc:id="3ab7d5e1-c13f-40fc-a80b-ed0abc7dcf5b" name="get:\send-report\(ID):student-report-service-config" />
		</munit:execution>
		<munit:validation >
			<munit-tools:assert-equals doc:name="Assert equals" doc:id="93c6f200-92cf-411f-ae0d-c3bc4e94e2aa" actual="#[payload.statusCode]" expected='#[404]' />
		</munit:validation>
	</munit:test>


</mule>
